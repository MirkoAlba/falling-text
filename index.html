<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Falling text</title>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.20.0/matter.min.js"
      integrity="sha512-6+7rTBmR6pRFe9fa0vCFjFaHZj/XYa7774bEBzRtxgdpIJOS++R3cKd6Prg/eJmxtsJotd8KAg4g57uuVQsZKA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <link rel="stylesheet" href="https://use.typekit.net/gwy5vve.css" />

    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container-boxes"></div>

    <script>
      /**
       *
       * Boxes
       * Array to manage the order and the quantity of the boxes
       *
       */

      const defaultObjectOptions = {
        angle: 0,
        restitution: 0.1,
        friction: 0.8,
        frictionAir: 0.05, // increasing the frictionAir will make the boxes fall faster
        sleepThreshold: 60, // make bodies sleep once their velocity hits a certain threshold
      };

      function mergeObjects(obj1, obj2) {
        return { ...obj1, ...obj2 };
      }

      var boxesToRender = [
        // pink boxes over the green ones
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4.5,
          y: -1100,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3.5,
          y: -1100,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -1100,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 2,
          y: -1100,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.75,
          y: -1100,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -1100,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 4,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -1100,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 4,
          }),
        },
        // row
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4.5,
          y: -1000,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3.5,
          y: -1000,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -1000,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 2,
          y: -1000,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.75,
          y: -1000,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -1000,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 4,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -1000,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 4,
          }),
        },
        // row
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 6,
          y: -900,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 5,
          y: -900,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4,
          y: -900,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -900,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 2,
          y: -900,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -900,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -900,
          objectOptions: defaultObjectOptions,
        },
        // row
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 6,
          y: -800,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 5,
          y: -800,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4,
          y: -800,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -800,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 2,
          y: -800,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -800,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -800,
          objectOptions: defaultObjectOptions,
        },
        // row
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 6,
          y: -700,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 5,
          y: -700,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4,
          y: -700,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -700,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -700,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -700,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.1,
          y: -700,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        // row
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 6,
          y: -600,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 5,
          y: -600,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 4,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4,
          y: -600,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 4,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -600,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -600,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 4,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -600,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.1,
          y: -600,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        // green boxes
        {
          type: "green",
          text: "NO WONDER",
          x: window.innerWidth / 5.25,
          y: -500,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "green",
          text: "THE SKIP",
          x: window.innerWidth / 4.5,
          y: -500,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "green",
          text: "BUTTON",
          x: window.innerWidth / 4,
          y: -500,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "green",
          text: "IS THE MOST",
          x: window.innerWidth / 3,
          y: -500,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "green",
          text: "POPULAR",
          x: window.innerWidth / 2,
          y: -500,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "green",
          text: "BUTTON",
          x: window.innerWidth / 1.25,
          y: -500,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "green",
          text: "EVER",
          x: window.innerWidth / 1.25,
          y: -500,
          objectOptions: defaultObjectOptions,
        },
        // pink boxes under the green ones
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 6,
          y: -400,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 5,
          y: -400,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4,
          y: -400,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -400,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 2,
          y: -400,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -400,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -400,
          objectOptions: defaultObjectOptions,
        },
        // 2nd row
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 6,
          y: -300,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 5,
          y: -300,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4,
          y: -300,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -300,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -300,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -300,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.1,
          y: -300,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        // 3rd row
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 6,
          y: -200,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 5,
          y: -200,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4,
          y: -200,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -200,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -200,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -200,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.1,
          y: -200,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI / 2,
          }),
        },
        // row
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 6,
          y: -100,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 5,
          y: -100,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 4,
          y: -100,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 3,
          y: -100,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.5,
          y: -100,
          objectOptions: defaultObjectOptions,
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.25,
          y: -100,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
        {
          type: "pink",
          text: "SKIP AD",
          x: window.innerWidth / 1.1,
          y: -100,
          objectOptions: mergeObjects(defaultObjectOptions, {
            angle: Math.PI,
          }),
        },
      ];

      if (window.innerHeight > 1080) {
        const extraPinkBoxesOver = [
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 6,
            y: -1200,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI / 2,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 5,
            y: -1200,
            objectOptions: defaultObjectOptions,
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 4,
            y: -1200,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 4,
            y: -1200,
            objectOptions: defaultObjectOptions,
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 2,
            y: -1200,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 1.5,
            y: -1200,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI / 4,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 1.25,
            y: -1200,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI / 4,
            }),
          },
          // row
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 6,
            y: -1300,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI / 2,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 5,
            y: -1300,
            objectOptions: defaultObjectOptions,
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 4,
            y: -1300,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 4,
            y: -1300,
            objectOptions: defaultObjectOptions,
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 2,
            y: -1300,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 1.5,
            y: -1300,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI / 4,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 1.25,
            y: -1300,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI / 4,
            }),
          },
        ];

        const extraPinkBoxesUnder = [
          // row
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 6,
            y: 0,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 5,
            y: 0,
            objectOptions: defaultObjectOptions,
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 4,
            y: 0,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 3,
            y: 0,
            objectOptions: defaultObjectOptions,
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 1.5,
            y: 0,
            objectOptions: defaultObjectOptions,
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 1.25,
            y: 0,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI,
            }),
          },
          {
            type: "pink",
            text: "SKIP AD",
            x: window.innerWidth / 1.1,
            y: 0,
            objectOptions: mergeObjects(defaultObjectOptions, {
              angle: Math.PI,
            }),
          },
        ];

        boxesToRender.unshift(...extraPinkBoxesOver);

        boxesToRender = [...boxesToRender, ...extraPinkBoxesUnder];
      }

      const containerBoxes = document.querySelector(".container-boxes");

      function insertAsFirstChild(
        newElementTag,
        referenceElement,
        newElementHTML = "",
        classList = [],
        elementId
      ) {
        // Create the new element
        const newElement = document.createElement(newElementTag);
        newElement.innerHTML = newElementHTML; // Set inner HTML content

        // Add classes if provided
        if (Array.isArray(classList) && classList.length > 0) {
          newElement.classList.add(...classList);
        }

        if (elementId) {
          newElement.id = elementId;
        }

        // Insert the new element as the first child of the reference element
        referenceElement.prepend(newElement);

        return newElement; // Return the new element
      }

      /**
       *
       * Matter JS
       *
       */

      const { Engine, Bodies, Composite, World } = Matter;

      // Engine, World
      const engine = Matter.Engine.create({
          enableSleeping: true,
        }),
        world = engine.world;

      const boxesElements = document.querySelectorAll(".box"),
        boxes = [];

      boxesToRender.forEach((boxOptions, i) => {
        var elementText = boxOptions.text;

        if (boxOptions.type === "pink") {
          elementText =
            boxOptions.text +
            '<svg xmlns="http://www.w3.org/2000/svg"version="1.1"viewBox="0 0 62 63"><polygon fill="#f4c6a2" points=".9 62.4 .9 .6 49.9 31.5 .9 62.4" /><rect fill="#f4c6a2" x="51.7" y=".6" width="9.5" height="61.8" /></svg>';
        }

        insertAsFirstChild(
          "div",
          containerBoxes,
          "<p>" + elementText + "</p>",
          ["box", "box--" + boxOptions.type],
          "box-" + i
        );

        const boxElement = document.getElementById("box-" + i);

        const boxPositionInfo = boxElement.getBoundingClientRect(),
          boxWidth = boxPositionInfo.width,
          boxHeight = boxPositionInfo.height;

        const matterJSBox = {
          w: boxWidth,
          h: boxHeight,
          body: Bodies.rectangle(
            boxOptions.x,
            boxOptions.y,
            boxWidth,
            boxHeight,
            boxOptions.objectOptions
          ),
          elem: boxElement,
          render() {
            const { x, y } = this.body.position;
            this.elem.style.top = `${y - this.h / 2}px`;
            this.elem.style.left = `${x - this.w / 2}px`;
            this.elem.style.transform = `rotate(${this.body.angle}rad)`;
          },
        };

        boxes.push(matterJSBox);
      });

      /**
       *
       * Walls constraints
       *
       */
      const walls = [
        // bottom
        Bodies.rectangle(
          window.innerWidth / 2,
          window.innerHeight,
          window.innerWidth,
          5,
          {
            isStatic: true,
            restitution: 0.01,
            density: 0.1,
            friction: 0.1,
          }
        ),

        // left
        Bodies.rectangle(0, window.innerHeight / 2, 5, window.innerHeight, {
          isStatic: true,
          restitution: 0.01,
          density: 0.1,
          friction: 0.1,
        }),

        // right
        Bodies.rectangle(
          window.innerWidth,
          window.innerHeight / 2,
          5,
          window.innerHeight,
          {
            isStatic: true,
            restitution: 0.01,
            density: 0.1,
            friction: 0.1,
          }
        ),
      ];

      // Add walls to world
      World.add(world, walls);

      // Add boxes to world
      const bodiesToAdd = [walls, ...boxes.map((b) => b.body)];

      Composite.add(world, bodiesToAdd);

      (function rerender() {
        boxes.forEach((box) => box.render());

        Engine.update(engine);

        requestAnimationFrame(rerender);
      })();
    </script>
  </body>
</html>
